<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Brainrot Sahur</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body {
  margin:0;
  font-family:sans-serif;
  background:#121212;
  color:#fff;
  display:flex;
  flex-direction:column;
  align-items:center;
  padding:15px;
}
h1 {margin-bottom:10px; font-size:20px; text-align:center;}
#canvasContainer {
  position:relative;
  width:100%;
  max-width:400px;
  border-radius:12px;
  overflow:hidden;
  background:#000;
}
canvas {
  width:100%;
  display:block;
}
#controls {
  margin-top:10px;
  width:100%;
  max-width:400px;
  display:flex;
  flex-direction:column;
  gap:10px;
}
button {
  padding:10px;
  font-size:14px;
  border-radius:8px;
  border:none;
  cursor:pointer;
  background:#0f0;
  color:#000;
  font-weight:bold;
}
</style>
</head>
<body>
<h1>Brainrot Sahur</h1>
<div id="canvasContainer">
  <canvas id="canvas"></canvas>
</div>
<div id="controls">
  <button id="modeBrainrot">Activer Brainrot</button>
  <button id="export">Exporter</button>
</div>

<script>
const canvas = document.getElementById('canvas');
const ctx = canvas.getContext('2d');
const modeBtn = document.getElementById('modeBrainrot');
const exportBtn = document.getElementById('export');

let brainrot = false;

// Image fixe Sahur
let img = new Image();
img.crossOrigin = "anonymous";
img.src = "https://static.wikia.nocookie.net/character-stats-and-profiles/images/5/52/Sahur2.webp/revision/latest?cb=20250510085254";

img.onload = () => {
  canvas.width = img.width * 0.7; // Redimension pour mobile
  canvas.height = img.height * 0.7;
  requestAnimationFrame(draw);
};

modeBtn.addEventListener('click', () => { brainrot = !brainrot; });

exportBtn.addEventListener('click', () => {
  const link = document.createElement('a');
  link.download = 'brainrot_sahur.png';
  link.href = canvas.toDataURL('image/png');
  link.click();
});

function draw() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);

  ctx.save();
  if (brainrot) {
    // Tremblement + décalage glitch
    const shakeX = (Math.random() - 0.5) * 15;
    const shakeY = (Math.random() - 0.5) * 15;
    ctx.translate(shakeX, shakeY);
  }

  ctx.drawImage(img, 0, 0, canvas.width, canvas.height);

  if (brainrot) {
    const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
    const data = imageData.data;
    for (let i = 0; i < data.length; i += 4) {
      // Brainrot : RGB décalé + bruit
      let r = data[i], g = data[i+1], b = data[i+2];
      data[i] = Math.min(255, r + Math.random()*100);
      data[i+1] = Math.min(255, b + Math.random()*100);
      data[i+2] = Math.min(255, g + Math.random()*100);
    }
    ctx.putImageData(imageData, 0, 0);
  }
  ctx.restore();

  requestAnimationFrame(draw);
}
</script>
</body>
</html>